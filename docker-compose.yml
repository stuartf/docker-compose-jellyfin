version: '3.5'
services:
  jellyfin:
    image: jellyfin/jellyfin
    user: ${JF_USER}
    network_mode: 'host'
    volumes:
      - ${JF_CONFIG_PATH}:/config
      - ${JF_CACHE_PATH}:/cache
      - /srv/media:/media:ro
      - ${JF_RECORDING_PATH}:/recordings
      - guide:/guide:ro
      - /srv/dockervols/jellyfin/post-process.sh:/post-process.sh
    restart: 'unless-stopped'
    devices:
      - /dev/dri:/dev/dri
      - /dev/vchiq:/dev/vchiq
      - /dev/video10:/dev/video10
      - /dev/video11:/dev/video11
      - /dev/video12:/dev/video12
    group_add:
      - video
    # Optional - alternative address used for autodiscovery
    environment:
      - JELLYFIN_PublishedServerUrl
    extra_hosts:
      - "host.docker.internal:host-gateway"
  zap2xml:
    image: shuaiscott/zap2xml
    restart: 'unless-stopped'
    environment:
      - USERNAME
      - PASSWORD
      - OPT_ARGS
    volumes:
      - guide:/data

volumes:
  guide:
